<html>
<head>
    <title>
        Excel-CSV file upload and processing
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body style="margin-top: 30px;margin-left: 30px;">
<h3>Excel-CSV file upload convert</h3>
<form action="{% url "index" %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="file"
           title="Upload csv file"
           name="excel_file"
           style="border: 1px solid black; padding: 5px;"
           required="required">
    <p>
        <br/>
        <input type="submit" class="btn btn-primary"
               value="I love uuuu"
               style="border: 1px solid green; padding:6px; border-radius: 3px; cursor: pointer;">
</form>


<p></p>
<p id="quote"></p>
<p id="log">Loading...</p>
<img src="" id="test" />
<hr>
</body>

<script type="text/javascript">
    getPicture ("36587311@N08", "test");
function getPicture (the_user_id, your_div_id){
    var apiKey = "80882b00609df75b919104b460459462"; // replace this with your API key
    $.getJSON(
        "https://talaikis.com/api/quotes/random/",
        {
            api_key: apiKey,
            format: 'json',
            nojsoncallback: 1,
        },
        function(data){
            $("#quote").text(data.quote + ' - ' + data.author);
        }
    );
    // get an array of random photos
    $.getJSON(
        "https://api.flickr.com/services/rest/",
        {
            //method: 'flickr.interestingness.getList',
            method: 'flickr.photos.search',
            api_key: apiKey,
            format: 'json',
            nojsoncallback: 1,
            text:"dog",
            tag_mode:"dogs, dog, cat, cats",
            page: Math.floor(Math.random()*100),
            safe_search: '1',
            per_page: 55 // you can increase this to get a bigger array
        },
        function(data){
            
            // if everything went good
            if(data.stat == 'ok'){
                
                $("#log").text("");
                // get a random id from the array
                var photo = data.photos.photo[ Math.floor( Math.random() * data.photos.photo.length ) ];
                
                // now call the flickr API and get the picture with a nice size
                $.getJSON(
                    "https://api.flickr.com/services/rest/",
                    {
                        method: 'flickr.photos.getSizes',
                        api_key: apiKey,
                        photo_id: photo.id,
                        format: 'json',
                        nojsoncallback: 1
                    },
                    function(response){
                        if(response.stat == 'ok'){
                            // $("#log").text("Second JSON is fine");
                            var the_url = response.sizes.size[5].source;
                            $("#"+your_div_id).attr("src", the_url);
                        }
                        else{
                            // $("#log").text("Second JSON is not good)");
                            console.log(" The request to get the picture was not good ");
                        }
                    }
                );
                
            }
            else{
                // $("#log").text("First JSON is not good)");
                console.log(" The request to get the array was not good :( ");
            }
        }
    );
}

</script>
</html>
